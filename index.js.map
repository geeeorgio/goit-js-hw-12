{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const refs = {\n  formEl: document.querySelector('.js-form'),\n  loaderEl: document.querySelector('.loader'),\n  galleryEl: document.querySelector('.gallery'),\n  loadMoreEl: document.querySelector('.load-more-btn'),\n};\n\nexport const collectInfo = {\n  page: 1,\n  query: '',\n  totalHits: null,\n  limit: 15,\n\n  getPage() {\n    return this.page;\n  },\n\n  setNewPage() {\n    this.page += 1;\n  },\n\n  getHits() {\n    return this.totalHits;\n  },\n\n  getQuery() {\n    return this.query;\n  },\n\n  setNewQuery(newQuery, newPage, newHits) {\n    this.query = newQuery;\n    this.page = newPage;\n    this.totalHits = newHits;\n  },\n\n  checkPages() {\n    return Math.ceil(this.totalHits / this.limit);\n  },\n\n  reset() {\n    this.query = '';\n    this.page = 1;\n    this.totalHits = null;\n    this.loadings = null;\n  },\n};\n\nexport function countPages(page) {\n  return ++page;\n}\n\nexport const lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'title',\n});\n\nexport function showSuccessMsg() {\n  iziToast.success({\n    title: 'Nice!',\n    message: 'Searching for pictures',\n    position: 'topRight',\n  });\n}\n\nexport function showWarningMsg() {\n  iziToast.warning({\n    title: 'Caution!',\n    message: 'Looks like you forgot to type something',\n    position: 'topRight',\n  });\n}\n\nexport function showErrorMsg(err) {\n  iziToast.error({\n    title: `${err}!`,\n    message:\n      'Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n    maxWidth: 500,\n  });\n}\n\nexport function renderGallery(images) {\n  refs.galleryEl.insertAdjacentHTML('beforeend', createGallery(images));\n  lightbox.refresh();\n}\n\nfunction createGallery(images) {\n  return images.map(renderGalleryItem).join('');\n}\n\nfunction renderGalleryItem(item) {\n  const {\n    largeImageURL,\n    webformatURL,\n    views,\n    comments,\n    likes,\n    downloads,\n    tags,\n  } = item;\n\n  const mainTag = tags ? tags.split(',')[0].trim() : 'image';\n\n  return `\n    <li class=\"response-list-item\">\n      <a class=\"simplelightbox-img-wrapper\" href=\"${largeImageURL}\">\n        <img\n          class=\"response-img\"\n          src=\"${webformatURL}\"\n          alt=\"${mainTag}\"\n          title=\"${mainTag}\"\n        />\n      </a>\n      <ul class=\"response-item-des-list\">\n        <li class=\"item-desc-element\" data-likes>\n          Likes\n          <p class=\"item-amount\">${likes}</p>\n        </li>\n        <li class=\"item-desc-element\" data-views>\n          Views\n          <p class=\"item-amount\">${views}</p>\n        </li>\n        <li class=\"item-desc-element\" data-comments>\n          Comments\n          <p class=\"item-amount\">${comments}</p>\n        </li>\n        <li class=\"item-desc-element\" data-downloads>\n          Downloads\n          <p class=\"item-amount\">${downloads}</p>\n        </li>\n      </ul>\n    </li>`;\n}\n\nexport function clearGallery() {\n  refs.galleryEl.innerHTML = '';\n}\n\nexport function showLoader() {\n  refs.loaderEl.style.display = 'flex';\n}\n\nexport function hideLoader() {\n  refs.loaderEl.style.display = 'none';\n}\n\nexport function showLoadMoreButton() {\n  refs.loadMoreEl.classList.add('show');\n}\n\nexport function hideLoadMoreButton() {\n  refs.loadMoreEl.classList.remove('show');\n}\n","import axios from 'axios';\n\nconst API_KEY = '50205845-1a821f8a08bf3bfbd622691da';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\naxios.defaults.params = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: 15,\n};\n\nexport async function getImagesByQuery(query, pg) {\n  try {\n    const response = await axios.get('', {\n      params: {\n        ...axios.defaults.params,\n        q: query,\n        page: pg ? pg : 1,\n      },\n    });\n\n    return response;\n  } catch (error) {\n    console.log(error);\n  }\n}\n","import * as functions from './js/render-functions';\nimport { getImagesByQuery } from './js/pixabay-api';\n\nfunctions.refs.formEl.addEventListener('submit', handleFormSubmit);\nfunctions.refs.loadMoreEl.addEventListener('click', handleLoadMoreClick);\n\nfunction handleFormSubmit(e) {\n  e.preventDefault();\n  functions.clearGallery();\n  functions.showLoader();\n  functions.collectInfo.reset();\n\n  const inputData = functions.refs.formEl.elements['search-text'].value.trim();\n  if (!inputData || inputData === '') {\n    functions.showWarningMsg();\n    functions.hideLoader();\n    return;\n  }\n\n  getImagesByQuery(inputData)\n    .then(response => {\n      const {\n        data: { hits, totalHits },\n        config: {\n          params: { page },\n        },\n      } = response;\n\n      if (hits.length === 0) {\n        throw new Error('Oups');\n      }\n\n      functions.renderGallery(hits);\n      functions.showLoadMoreButton();\n      functions.collectInfo.setNewQuery(inputData, page, totalHits);\n    })\n    .catch(error => {\n      functions.showErrorMsg(error);\n    })\n    .finally(() => {\n      functions.hideLoader();\n    });\n\n  functions.refs.formEl.reset();\n}\n\nfunction handleLoadMoreClick() {\n  const totalPages = functions.collectInfo.checkPages();\n  const page = functions.collectInfo.getPage();\n  if (totalPages < page) {\n    functions.hideLoadMoreButton();\n    throw new Error(\n      `We're sorry, but you've reached the end of search results.`\n    );\n  }\n  const query = functions.collectInfo.getQuery();\n  const newPage = functions.collectInfo.setNewPage();\n\n  getImagesByQuery(query, newPage)\n    .then(response => {\n      console.log(response);\n      functions.renderGallery(response.data.hits);\n      functions.showLoadMoreButton();\n    })\n    .catch(error => {\n      functions.showErrorMsg(error);\n    })\n    .finally(() => {\n      functions.hideLoader();\n    });\n}\n"],"names":["refs","collectInfo","newQuery","newPage","newHits","lightbox","SimpleLightbox","showWarningMsg","iziToast","showErrorMsg","err","renderGallery","images","createGallery","renderGalleryItem","item","largeImageURL","webformatURL","views","comments","likes","downloads","tags","mainTag","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","API_KEY","axios","getImagesByQuery","query","pg","error","functions.refs","handleFormSubmit","handleLoadMoreClick","e","functions.clearGallery","functions.showLoader","functions.collectInfo","inputData","functions.showWarningMsg","functions.hideLoader","response","hits","totalHits","page","functions.renderGallery","functions.showLoadMoreButton","functions.showErrorMsg","totalPages","functions.hideLoadMoreButton"],"mappings":"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"}