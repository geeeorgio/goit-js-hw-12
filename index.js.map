{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const refs = {\n  formEl: document.querySelector('.js-form'),\n  loaderEl: document.querySelector('.loader'),\n  galleryEl: document.querySelector('.gallery'),\n  loadMoreEl: document.querySelector('.load-more-btn'),\n};\n\n// === pagination ===\n\nexport const collectInfo = {\n  page: 1,\n  query: '',\n  totalHits: null,\n  limit: 15,\n\n  getPage() {\n    return this.page;\n  },\n\n  setNewPage() {\n    this.page += 1;\n  },\n\n  getQuery() {\n    return this.query;\n  },\n\n  setNewQuery(newQuery, newPage, newHits) {\n    this.query = newQuery;\n    this.page = newPage;\n    this.totalHits = newHits;\n  },\n\n  hitsLeft() {\n    return this.totalHits - this.page * this.limit;\n  },\n\n  reset() {\n    this.query = '';\n    this.page = 1;\n    this.totalHits = null;\n  },\n};\n\n// === lightbox ===\n\nexport const lightbox = new SimpleLightbox('.gallery a', {\n  captionDelay: 250,\n  captionsData: 'title',\n});\n\n// === notifications ===\n\nexport function showSuccessMsg(amount = 1) {\n  iziToast.success({\n    timeout: 3333,\n    title: 'Nice!',\n    message: `You found ${amount} images`,\n    position: 'topRight',\n  });\n}\n\nexport function showWarningMsg(warn = '') {\n  iziToast.warning({\n    timeout: 3333,\n    title: 'Caution!',\n    message: `${warn}`,\n    position: 'topRight',\n  });\n}\n\nexport function showErrorMsg(err = '') {\n  iziToast.error({\n    timeout: 3333,\n    title: 'Oups!',\n    message: `${err}`,\n    position: 'topRight',\n    maxWidth: 450,\n  });\n}\n\n// === gallery ===\n\nexport function renderGallery(images) {\n  if (!images || images.length === 0) return;\n  refs.galleryEl.insertAdjacentHTML('beforeend', createGallery(images));\n  lightbox.refresh();\n}\n\nfunction createGallery(images = []) {\n  return images.map(renderGalleryItem).join('');\n}\n\nfunction renderGalleryItem(item = {}) {\n  const {\n    largeImageURL,\n    webformatURL,\n    views,\n    comments,\n    likes,\n    downloads,\n    tags,\n  } = item;\n\n  const mainTag = tags ? tags.split(',')[0].trim() : 'image';\n\n  return `\n    <li class=\"response-list-item\">\n      <a class=\"simplelightbox-img-wrapper\" href=\"${largeImageURL}\">\n        <img\n          class=\"response-img\"\n          src=\"${webformatURL}\"\n          alt=\"${mainTag}\"\n          title=\"${mainTag}\"\n        />\n      </a>\n      <ul class=\"response-item-des-list\">\n        <li class=\"item-desc-element\" data-likes>\n          Likes\n          <p class=\"item-amount\">${likes}</p>\n        </li>\n        <li class=\"item-desc-element\" data-views>\n          Views\n          <p class=\"item-amount\">${views}</p>\n        </li>\n        <li class=\"item-desc-element\" data-comments>\n          Comments\n          <p class=\"item-amount\">${comments}</p>\n        </li>\n        <li class=\"item-desc-element\" data-downloads>\n          Downloads\n          <p class=\"item-amount\">${downloads}</p>\n        </li>\n      </ul>\n    </li>`;\n}\n\nexport function clearGallery() {\n  refs.galleryEl.innerHTML = '';\n}\n\n// === loaders ===\n\nexport function showLoader() {\n  refs.loaderEl.style.display = 'flex';\n}\n\nexport function hideLoader() {\n  refs.loaderEl.style.display = 'none';\n}\n\nexport function showLoadMoreButton() {\n  refs.loadMoreEl.classList.add('show');\n}\n\nexport function hideLoadMoreButton() {\n  refs.loadMoreEl.classList.remove('show');\n}\n\n// === rect/scroll ===\n\nexport function getRect(obj = {}) {\n  return obj.getBoundingClientRect();\n}\n\nexport function getItemHeight(obj = {}) {\n  return obj.height;\n}\n\nexport function scrollItem(height = 1) {\n  window.scrollBy({\n    top: height * 2,\n    behavior: 'smooth',\n  });\n}\n","import axios from 'axios';\nimport { showErrorMsg } from './render-functions';\n\nconst API_KEY = '50205845-1a821f8a08bf3bfbd622691da';\n\naxios.defaults.baseURL = 'https://pixabay.com/api/';\naxios.defaults.params = {\n  key: API_KEY,\n  image_type: 'photo',\n  orientation: 'horizontal',\n  safesearch: 'true',\n  per_page: 15,\n};\n\nexport async function getImagesByQuery(query = '', page = 1) {\n  try {\n    const response = await axios.get('', {\n      params: {\n        ...axios.defaults.params,\n        q: query,\n        page: page ? page : 1,\n      },\n    });\n\n    return response;\n  } catch (error) {\n    console.log(error);\n    showErrorMsg(error);\n  }\n}\n","import * as functions from './js/render-functions';\nimport { getImagesByQuery } from './js/pixabay-api';\n\nfunctions.refs.formEl.addEventListener('submit', handleFormSubmit);\nfunctions.refs.loadMoreEl.addEventListener('click', handleLoadMoreClick);\n\nasync function handleFormSubmit(e) {\n  try {\n    e.preventDefault();\n    functions.clearGallery();\n    functions.hideLoadMoreButton();\n    functions.showLoader();\n    functions.collectInfo.reset();\n\n    const inputData =\n      functions.refs.formEl.elements['search-text'].value.trim();\n    if (!inputData || inputData === '') {\n      functions.showWarningMsg('Looks like you forgot to type something');\n      functions.hideLoader();\n      return;\n    }\n\n    const {\n      data: { hits, totalHits },\n      config: {\n        params: { page },\n      },\n    } = await getImagesByQuery(inputData);\n\n    if (hits.length === 0) {\n      functions.showErrorMsg(\n        'There are no images matching your search query. Please try again!'\n      );\n      return;\n    }\n\n    functions.collectInfo.setNewQuery(inputData, page, totalHits);\n    functions.renderGallery(hits);\n    functions.showSuccessMsg(totalHits);\n\n    if (hits.length < functions.collectInfo.limit) {\n      functions.showWarningMsg(`These are all results found.`);\n      return;\n    }\n\n    functions.showLoadMoreButton();\n  } catch (err) {\n    functions.showErrorMsg(err);\n  } finally {\n    functions.hideLoader();\n  }\n\n  functions.refs.formEl.reset();\n}\n\nasync function handleLoadMoreClick() {\n  try {\n    functions.showLoader();\n\n    if (functions.collectInfo.hitsLeft() <= 0) {\n      functions.hideLoadMoreButton();\n      functions.showWarningMsg(`No more images to load.`);\n      return;\n    }\n\n    const query = functions.collectInfo.getQuery();\n    functions.collectInfo.setNewPage();\n    const newPage = functions.collectInfo.getPage();\n\n    const {\n      data: { hits },\n    } = await getImagesByQuery(query, newPage);\n\n    functions.renderGallery(hits);\n\n    const listItem = document.querySelector('.gallery .response-list-item ');\n    const listItemParams = functions.getRect(listItem);\n    const itemHeight = functions.getItemHeight(listItemParams);\n    functions.scrollItem(itemHeight);\n\n    if (hits.length < functions.collectInfo.limit) {\n      functions.hideLoadMoreButton();\n      functions.showErrorMsg(\n        `We're sorry, but you've reached the end of search results.`\n      );\n    }\n  } catch (err) {\n    functions.showErrorMsg(err);\n  } finally {\n    functions.hideLoader();\n  }\n}\n"],"names":["refs","collectInfo","newQuery","newPage","newHits","lightbox","SimpleLightbox","showSuccessMsg","amount","iziToast","showWarningMsg","warn","showErrorMsg","err","renderGallery","images","createGallery","renderGalleryItem","item","largeImageURL","webformatURL","views","comments","likes","downloads","tags","mainTag","clearGallery","showLoader","hideLoader","showLoadMoreButton","hideLoadMoreButton","getRect","obj","getItemHeight","scrollItem","height","API_KEY","axios","getImagesByQuery","query","page","error","functions.refs","handleFormSubmit","handleLoadMoreClick","functions.clearGallery","functions.hideLoadMoreButton","functions.showLoader","functions.collectInfo","inputData","functions.showWarningMsg","functions.hideLoader","hits","totalHits","functions.showErrorMsg","functions.renderGallery","functions.showSuccessMsg","functions.showLoadMoreButton","listItem","listItemParams","functions.getRect","itemHeight","functions.getItemHeight","functions.scrollItem"],"mappings":"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"}